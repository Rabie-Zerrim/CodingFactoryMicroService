<nav class="navbar navbar-expand-lg navbar-light header-navbar {{transparentBGClass}}"
  [ngClass]="{
    'navbar-brand-center': menuPosition === 'Top',
    'navbar-static': menuPosition === 'Side' && config?.layout.navbar.type === 'Static',
    'navbar-sticky': menuPosition === 'Side' && config?.layout.navbar.type === 'Fixed',
    'fixed-top': isSmallScreen && menuPosition === 'Top'
  }">
  <div class="container-fluid navbar-wrapper">
    <div class="navbar-header d-flex">
      <div class="navbar-toggle menu-toggle d-xl-none d-block float-left align-items-center justify-content-center"
        (click)="toggleSidebar()">
        <i class="ft-menu font-medium-3"></i>
      </div>
      <ul class="navbar-nav" (clickOutside)="toggleSearchOpenClass(false)">
        <li class="nav-item mr-2 d-none d-lg-block">
          <a class="nav-link apptogglefullscreen" id="navbar-fullscreen" href="javascript:;" appToggleFullscreen
            (click)="ToggleClass()"><i class="{{toggleClass}} font-medium-3"></i></a>
        </li>
        <li class="nav-item nav-search">
          <a class="nav-link nav-link-search" id="navbar-search" href="javascript:" (click)="toggleSearchOpenClass(true)">
            <i class="ft-search font-medium-3"></i>
          </a>
        </li>
      </ul>
      <div class="navbar-brand-center">
        <div class="navbar-header">
          <ul class="navbar-nav">
            <li class="nav-item">
              <div class="logo">
                <a class="logo-text" [routerLink]="['/']">
                  <div class="logo-img">
                    <img class="logo-img" alt="Apex logo" [src]="logoUrl">
                  </div>
                  <span class="text">APEX</span>
                </a>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="navbar-container">
      <div class="collapse navbar-collapse d-block" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <!-- Notification Bell Dropdown -->
          <li class="dropdown nav-item" ngbDropdown>
            <a class="nav-link dropdown-toggle p-0 mt-2" ngbDropdownToggle>
              <i class="ft-bell font-medium-3"></i>
              <span class="badge badge-pill badge-danger">{{ notifications.length }}</span>
            </a>

            <!-- Dropdown Menu -->
            <ul ngbDropdownMenu class="dropdown-menu dropdown-menu-right p-0" style="min-width: 300px;">
              <li class="bg-primary text-white p-2 d-flex justify-content-between align-items-center">
                <span><i class="ft-bell mr-2"></i>{{ notifications.length }} Notifications</span>
              </li>

              <li *ngIf="notifications.length === 0" class="p-3 text-muted text-center">
                No new notifications
              </li>

              <li *ngFor="let notif of latestNotifications" class="dropdown-item border-bottom py-2">
                <div class="d-flex">
                  <i class="fa me-2 mt-1 text-primary" [ngClass]="notif.icon || 'fa-info-circle'"></i>
                  <div>
                    <strong>{{ notif.title }}</strong>
                    <div class="small text-muted">{{ notif.message }}</div>
                  </div>
                </div>
              </li>

              <!-- See All Button -->
              <li class="dropdown-item text-center text-primary py-2"
                  *ngIf="notifications.length > maxDisplay"
                  (click)="openAllNotifications(allNotifsModal)">
                <strong>See All Notifications</strong>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</nav>

<!-- All Notifications Modal Template -->
<ng-template #allNotifsModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">All Notifications</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
    <div *ngIf="notifications.length === 0" class="text-muted text-center">No notifications available.</div>

    <div *ngFor="let notif of notifications" class="border-bottom pb-2 mb-2">
      <div class="d-flex align-items-start">
        <!-- Icon for each notification -->
        <i class="fa me-2 mt-1" [ngClass]="notif.icon || 'fa-info-circle'"></i>
        <div>
          <strong>{{ notif.title }}</strong><br />
          <small class="text-muted">{{ notif.message }}</small>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-outline-secondary" (click)="modal.close()">Close</button>
  </div>
</ng-template>
